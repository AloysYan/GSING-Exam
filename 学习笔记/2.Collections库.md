## ğŸ“š collections åº“ä»‹ç»
- collections æ˜¯Pythonçš„æ ‡å‡†åº“ï¼Œæä¾›äº†è®¸å¤šå¢å¼ºç‰ˆçš„æ•°æ®å®¹å™¨ï¼Œæ¯”å†…ç½®çš„æ•°æ®ç±»å‹æ›´å¼ºå¤§ã€æ›´æ–¹ä¾¿ã€‚

```python
from collections import defaultdict, Counter, deque, namedtuple
# è¿™äº›éƒ½æ˜¯collectionsä¸­çš„å¸¸ç”¨å·¥å…·
```

## ğŸ” defaultdict è¯¦è§£
**ä»€ä¹ˆæ˜¯defaultdictï¼Ÿ**
- defaultdictæ˜¯å­—å…¸(dict)çš„å¢å¼ºç‰ˆï¼Œä¸»è¦è§£å†³äº†ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼šå½“è®¿é—®ä¸å­˜åœ¨çš„é”®æ—¶ï¼Œä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚

**æ™®é€šå­—å…¸çš„é—®é¢˜**
```python
# æ™®é€šå­—å…¸
normal_dict = {}

# å°è¯•è®¿é—®ä¸å­˜åœ¨çš„é”®
try:
    print(normal_dict['ä¸å­˜åœ¨é”®'])  # ä¼šæŠ¥é”™ï¼
except KeyError as e:
    print(f"å‡ºé”™äº†ï¼š{e}")  # KeyError: 'ä¸å­˜åœ¨é”®'

# éœ€è¦å…ˆæ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
if 'æŸä¸ªé”®' in normal_dict:
    value = normal_dict['æŸä¸ªé”®']
else:
    value = []  # è®¾ç½®é»˜è®¤å€¼
```
**defaultdictçš„è§£å†³æ–¹æ¡ˆ**
```python
from collections import defaultdict

# åˆ›å»ºdefaultdictï¼ŒæŒ‡å®šé»˜è®¤å€¼ç±»å‹
dd = defaultdict(list)  # é»˜è®¤å€¼ä¸ºç©ºåˆ—è¡¨

print(dd['æ–°é”®'])  # è¿”å› []ï¼Œä¸ä¼šæŠ¥é”™ï¼
dd['æ–°é”®'].append('æ•°æ®1')  # å¯ä»¥ç›´æ¥æ“ä½œ
print(dd)  # defaultdict(<class 'list'>, {'æ–°é”®': ['æ•°æ®1']})
```

## ğŸ¯ defaultdict çš„å¸¸è§ç”¨æ³•
**1. é»˜è®¤å€¼ä¸ºåˆ—è¡¨ (list)**
```python
from collections import defaultdict

# åˆ†ç»„æ•°æ®ç¤ºä¾‹
students = [
    ('ç­çº§A', 'å°æ˜'),
    ('ç­çº§B', 'å°çº¢'),
    ('ç­çº§A', 'å°åˆš'),
    ('ç­çº§C', 'å°ä¸½'),
    ('ç­çº§B', 'å°å')
]

# æŒ‰ç­çº§åˆ†ç»„å­¦ç”Ÿ
class_students = defaultdict(list)

for class_name, student in students:
    class_students[class_name].append(student)

print(dict(class_students))
# è¾“å‡ºï¼š{'ç­çº§A': ['å°æ˜', 'å°åˆš'], 'ç­çº§B': ['å°çº¢', 'å°å'], 'ç­çº§C': ['å°ä¸½']}
```
**2. é»˜è®¤å€¼ä¸ºæ•´æ•° (int)**
```python
from collections import defaultdict

# è®¡æ•°ç¤ºä¾‹
words = ['apple', 'banana', 'apple', 'orange', 'banana', 'apple']

word_count = defaultdict(int)  # é»˜è®¤å€¼ä¸º0

for word in words:
    word_count[word] += 1

print(dict(word_count))
# è¾“å‡ºï¼š{'apple': 3, 'banana': 2, 'orange': 1}
```
**3. é»˜è®¤å€¼ä¸ºé›†åˆ (set)**
```python
from collections import defaultdict

# å»é‡åˆ†ç»„ç¤ºä¾‹
data = [
    ('åŸå¸‚', 'åŒ—äº¬'),
    ('åŸå¸‚', 'ä¸Šæµ·'),
    ('æ°´æœ', 'è‹¹æœ'),
    ('åŸå¸‚', 'åŒ—äº¬'),  # é‡å¤æ•°æ®
    ('æ°´æœ', 'é¦™è•‰')
]

category_items = defaultdict(set)

for category, item in data:
    category_items[category].add(item)  # setä¼šè‡ªåŠ¨å»é‡

print({k: list(v) for k, v in category_items.items()})  # å­—å…¸æ¨å¯¼å¼
# è¾“å‡ºï¼š{'åŸå¸‚': ['åŒ—äº¬', 'ä¸Šæµ·'], 'æ°´æœ': ['è‹¹æœ', 'é¦™è•‰']}
```
**4. è‡ªå®šä¹‰é»˜è®¤å€¼**
```python
from collections import defaultdict

# ä½¿ç”¨lambdaå‡½æ•°è‡ªå®šä¹‰é»˜è®¤å€¼
def default_value():
    return "æœªçŸ¥å€¼"

dd = defaultdict(default_value)
# æˆ–è€…ä½¿ç”¨lambda
dd = defaultdict(lambda: "é»˜è®¤æ¶ˆæ¯")

print(dd['ä»»æ„é”®'])  # è¾“å‡º: "é»˜è®¤æ¶ˆæ¯"
```

## ğŸ–¼ï¸ defaultdictåœ¨OpenCVä¸­çš„åº”ç”¨
**åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œdefaultdictä¹Ÿå¾ˆæœ‰ç”¨ï¼š**

```python
from collections import defaultdict
import cv2
import numpy as np

# ç¤ºä¾‹ï¼šç»Ÿè®¡å›¾åƒä¸­æ¯ç§é¢œè‰²çš„åƒç´ æ•°é‡
def count_colors(image_path):
    img = cv2.imread(image_path)
    color_count = defaultdict(int)
    
    # éå†æ¯ä¸ªåƒç´ 
    for row in img:
        for pixel in row:
            # å°†BGRå…ƒç»„ä½œä¸ºé”®
            color_tuple = tuple(pixel)
            color_count[color_tuple] += 1
    
    return color_count

# ç¤ºä¾‹ï¼šæŒ‰åŒºåŸŸåˆ†ç»„å›¾åƒç‰¹å¾
def group_features_by_region(features, regions):
    region_features = defaultdict(list)
    
    for feature, region in zip(features, regions):
        region_features[region].append(feature)
    
    return region_features
```

## ğŸ“Š collections åº“çš„å…¶ä»–æœ‰ç”¨å·¥å…·
**1. Counter - è®¡æ•°å™¨**
```python
from collections import Counter

words = ['a', 'b', 'c', 'a', 'b', 'a']
counter = Counter(words)
print(counter)  # Counter({'a': 3, 'b': 2, 'c': 1})
print(counter.most_common(2))  # [('a', 3), ('b', 2)]
```
**2. deque - åŒç«¯é˜Ÿåˆ—**
```python
from collections import deque

dq = deque([1, 2, 3])
dq.append(4)      # å³è¾¹æ·»åŠ 
dq.appendleft(0)  # å·¦è¾¹æ·»åŠ 
print(dq)         # deque([0, 1, 2, 3, 4])
```

## ğŸ¯ å­¦ä¹ å»ºè®®
**ä»€ä¹ˆæ—¶å€™ä½¿ç”¨defaultdictï¼Ÿ**
- éœ€è¦åˆ†ç»„æ•°æ®æ—¶ï¼ˆç‰¹åˆ«æ˜¯åˆ—è¡¨åˆ†ç»„ï¼‰
- éœ€è¦è®¡æ•°æ—¶
- é¿å…é¢‘ç¹æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨æ—¶
- æ„å»ºå¤æ‚åµŒå¥—ç»“æ„æ—¶

#### å®è·µç»ƒä¹ ï¼š
```python
from collections import defaultdict

# ç»ƒä¹ 1ï¼šç»Ÿè®¡å¥å­ä¸­æ¯ä¸ªå•è¯çš„é¦–å­—æ¯
sentence = "hello world how are you today"
# ç›®æ ‡ï¼š{'h': ['hello', 'how'], 'w': ['world'], ...}

# ç»ƒä¹ 2ï¼šæŒ‰æˆç»©ç­‰çº§åˆ†ç»„å­¦ç”Ÿ
students = [('å°æ˜', 85), ('å°çº¢', 92), ('å°åˆš', 78), ('å°ä¸½', 95)]
# ç›®æ ‡ï¼š{'A': [92, 95], 'B': [85], 'C': [78]}
```

**æ€»ç»“ï¼šdefaultdictè®©å­—å…¸æ“ä½œæ›´å®‰å…¨ã€æ›´ç®€æ´ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†åˆ†ç»„å’Œè®¡æ•°åœºæ™¯ã€‚åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç»„ç»‡ç‰¹å¾æ•°æ®ã€ç»Ÿè®¡åƒç´ ä¿¡æ¯ç­‰ã€‚**