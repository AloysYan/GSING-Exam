## 什么是掩码（Mask）

### 一、基本概念

掩码（Mask）是一个与图像尺寸相同的二值图像，用于标记哪些像素需要处理或保留。

- 白色区域（值为 255）：保留/处理
- 黑色区域（值为 0）：忽略/排除

### 二、在代码中的应用

```36:42:T3/T3.py
    if cname == 'red':
        mask1 = cv2.inRange(hsv, color_ranges['red1'][0], color_ranges['red1'][1])
        mask2 = cv2.inRange(hsv, color_ranges['red2'][0], color_ranges['red2'][1])
        mask = cv2.bitwise_or(mask1, mask2)
    else:
        low, high = color_ranges[cname]
        mask = cv2.inRange(hsv, low, high)
```

#### `cv2.inRange()` 函数的作用

- 功能：根据颜色范围生成掩码
- 参数：
  - `hsv`：HSV 图像
  - `low`：HSV 下限
  - `high`：HSV 上限
- 返回值：二值图像（NumPy 数组）
  - 在范围内的像素 → 255（白色）
  - 不在范围内的像素 → 0（黑色）

### 三、掩码的视觉效果

假设原图中有红色方块：

```
原图（HSV）：
[各种颜色的像素混合在一起]

掩码（二值图）：
[只有红色区域是白色，其他都是黑色]
```

### 四、掩码的后续使用

```43:43:T3/T3.py
    contours, _ = cv2.findContours(mask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
```

- `cv2.findContours()` 在掩码上查找轮廓
- 只处理白色区域，忽略黑色区域
- 从而提取出目标颜色的区域

### 五、红色掩码的特殊处理

```36:39:T3/T3.py
    if cname == 'red':
        mask1 = cv2.inRange(hsv, color_ranges['red1'][0], color_ranges['red1'][1])
        mask2 = cv2.inRange(hsv, color_ranges['red2'][0], color_ranges['red2'][1])
        mask = cv2.bitwise_or(mask1, mask2)
```

- 原因：HSV 中红色跨越 0°（0-10 和 160-179）
- 方法：生成两个掩码，用 `cv2.bitwise_or()` 合并

### 六、掩码的数据结构

- 类型：NumPy 数组（`numpy.ndarray`）
- 形状：与原始图像相同（高度 × 宽度）
- 数据类型：通常是 `uint8`
- 值：只有 0 和 255

### 七、类比理解

- 掩码像“模板”或“遮罩”，标记“要处理”和“不处理”的区域
- 类似 Photoshop 的选区，只对选中区域进行操作

### 总结

掩码是二值图像，用于标记目标区域：
- 生成方式：`cv2.inRange()` 根据颜色范围生成
- 作用：筛选出符合颜色条件的像素
- 用途：用于轮廓检测、区域提取等后续处理

在代码中，掩码用于从 HSV 图像中提取特定颜色的区域，然后在这些区域上查找轮廓，从而检测出彩色方块。