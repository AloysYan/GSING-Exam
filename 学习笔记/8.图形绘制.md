# 图形的绘制

## `cv2.drawContours()` 和 `cv2.circle()` 函数详解

### 一、`cv2.drawContours()` - 绘制轮廓

```py
        cv2.drawContours(image, [box], 0, gray_color, 3)
```

#### 函数签名
```python
cv2.drawContours(image, contours, contourIdx, color, thickness)
```

#### 参数说明

| 参数 | 类型 | 说明 |
|------|------|------|
| `image` | `np.ndarray` | 要绘制的目标图像（会被修改） |
| `contours` | `list` | 轮廓列表，每个元素是一个轮廓点集 |
| `contourIdx` | `int` | 要绘制的轮廓索引，`-1` 表示绘制所有轮廓 |
| `color` | `tuple` | 颜色，BGR 格式 `(B, G, R)` |
| `thickness` | `int` | 线宽，`-1` 表示填充 |

#### 在代码中的使用

```py
        cv2.drawContours(image, [box], 0, gray_color, 3)
```

- `image`：原图（会被修改）
- `[box]`：将 `box` 包装成列表（函数需要轮廓列表）
- `0`：绘制第一个（也是唯一的）轮廓
- `gray_color`：`(64, 64, 64)`，灰色
- `3`：线宽 3 像素

#### 为什么用 `[box]`？

`cv2.drawContours()` 需要轮廓列表，即使只有一个轮廓也要传入列表：
```python
# 正确：传入列表
cv2.drawContours(image, [box], 0, color, thickness)

# 错误：直接传入数组
cv2.drawContours(image, box, 0, color, thickness)  # 会报错
```

#### `box` 的格式

```py
        box = cv2.boxPoints(rect)
        box = box.astype(int)
```

- `box` 形状：`(4, 2)`，4 个顶点的 `(x, y)` 坐标
- 示例：
```python
box = [[x1, y1],
       [x2, y2],
       [x3, y3],
       [x4, y4]]
```

#### 绘制效果

- 在图像上绘制矩形的 4 条边
- 颜色：灰色 `(64, 64, 64)`
- 线宽：3 像素

---

### 二、`cv2.circle()` - 绘制圆形

```py
        cv2.circle(image, (cx, cy), 4, (0, 0, 0), -1)
```

#### 函数签名
```python
cv2.circle(image, center, radius, color, thickness)
```

#### 参数说明

| 参数 | 类型 | 说明 |
|------|------|------|
| `image` | `np.ndarray` | 要绘制的目标图像（会被修改） |
| `center` | `tuple` | 圆心坐标 `(x, y)` |
| `radius` | `int` | 半径（像素） |
| `color` | `tuple` | 颜色，BGR 格式 `(B, G, R)` |
| `thickness` | `int` | 线宽，`-1` 表示填充，正数表示边框宽度 |

#### 在代码中的使用

```py
        cv2.circle(image, (cx, cy), 4, (0, 0, 0), -1)
```

- `image`：原图（会被修改）
- `(cx, cy)`：圆心坐标（矩形中心）
- `4`：半径 4 像素
- `(0, 0, 0)`：黑色（BGR）
- `-1`：填充（实心圆）

#### `thickness` 参数说明

| 值 | 效果 |
|---|------|
| `-1` | 填充（实心圆） |
| `1, 2, 3...` | 边框宽度（像素） |

#### 绘制效果

- 在矩形中心绘制一个黑色实心圆
- 半径：4 像素
- 用途：标记检测到的方块中心点

---

### 三、两个函数的配合使用

```py
        # 绘制旋转矩形和中心点
        box = cv2.boxPoints(rect)
        box = box.astype(int)
        
        # 绘制灰色边框
        gray_color = (64, 64, 64)
        cv2.drawContours(image, [box], 0, gray_color, 3)
        cv2.circle(image, (cx, cy), 4, (0, 0, 0), -1)
```

**工作流程：**
1. 将最小外接矩形转换为 4 个顶点
2. 绘制灰色矩形边框（标记检测区域）
3. 在中心绘制黑色实心圆（标记中心点）

**视觉效果：**
```
图像上会显示：
┌─────────────┐  ← 灰色矩形边框（3像素宽）
│             │
│      ●      │  ← 黑色中心点（半径4像素）
│             │
└─────────────┘
```

---

### 四、颜色格式说明

两个函数都使用 BGR 格式（不是 RGB）：

```python
# BGR 格式 (Blue, Green, Red)
gray_color = (64, 64, 64)      # 灰色
black = (0, 0, 0)               # 黑色
white = (255, 255, 255)         # 白色
red = (0, 0, 255)               # 红色
green = (0, 255, 0)             # 绿色
blue = (255, 0, 0)              # 蓝色
```

**注意：** OpenCV 使用 BGR，与常见的 RGB 顺序不同。

---

### 五、函数特点对比

| 特性 | `cv2.drawContours()` | `cv2.circle()` |
|------|---------------------|----------------|
| **用途** | 绘制轮廓/多边形 | 绘制圆形 |
| **输入** | 轮廓点集列表 | 圆心和半径 |
| **灵活性** | 可绘制任意形状 | 只能绘制圆形 |
| **填充** | `thickness=-1` 填充 | `thickness=-1` 填充 |
| **修改图像** | 直接修改原图 | 直接修改原图 |

---

### 六、其他绘制函数

OpenCV 还提供其他绘制函数：

```python
# 绘制直线
cv2.line(image, pt1, pt2, color, thickness)

# 绘制矩形（不旋转）
cv2.rectangle(image, pt1, pt2, color, thickness)

# 绘制椭圆
cv2.ellipse(image, center, axes, angle, startAngle, endAngle, color, thickness)

# 绘制文字
cv2.putText(image, text, org, font, scale, color, thickness)
```

---

### 七、注意事项

1. 图像会被直接修改：这两个函数会修改原图，如需保留原图请先复制
2. 坐标系统：原点在左上角，x 向右，y 向下
3. 数据类型：坐标和颜色值应为整数
4. 性能：绘制操作会修改图像数组，频繁调用可能影响性能

---

### 总结

- `cv2.drawContours()`：用于绘制矩形边框，标记检测区域
- `cv2.circle()`：用于绘制中心点，标记方块位置

两者配合使用，在图像上可视化检测结果，便于查看和验证检测效果。